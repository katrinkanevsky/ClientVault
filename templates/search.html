{% extends "base.html" %}
{% block title %}Search Clients · ClientVault{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Search Clients</h1>

{% if msg %}
  <div class="mb-4 rounded-lg bg-red-50 text-red-700 p-3">{{ msg }}</div>
{% endif %}

<form method="POST" class="bg-white rounded-xl shadow border border-slate-200 p-6 space-y-4 mb-6">
  <div class="grid sm:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-medium">First Name</label>
      <input type="text" name="first_name" placeholder="e.g., Anna" value="{{ q.first_name }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
    <div>
      <label class="block text-sm font-medium">Last Name</label>
      <input type="text" name="last_name" placeholder="e.g., Lee" value="{{ q.last_name }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
    <div>
      <label class="block text-sm font-medium">Email</label>
      <input type="text" name="email" placeholder="e.g., anna@firm.com" value="{{ q.email }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
    <div>
      <label class="block text-sm font-medium">Phone</label>
      <input type="text" name="phone" placeholder="e.g., 555-123-4567" value="{{ q.phone }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
    <div>
      <label class="block text-sm font-medium">Driver's License</label>
      <input type="text" name="dl_number" placeholder="e.g., D1234567" value="{{ q.dl_number }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
    <div>
      <label class="block text-sm font-medium">Date of Loss</label>
      <input type="date" name="date_of_loss" value="{{ q.date_of_loss }}" class="mt-1 block w-full rounded-md border-slate-300 focus:border-lilac-300 focus:ring-lilac-300"/>
    </div>
  </div>
  <div class="flex gap-2">
    <button class="inline-flex items-center rounded-lg px-4 py-2 text-white bg-lilac-500 hover:opacity-95">Search</button>
    <a href="/dashboard" class="inline-flex items-center rounded-lg px-4 py-2 border border-lilac-500 text-lilac-500 hover:bg-lilac-500 hover:text-white">← Back to Dashboard</a>
  </div>
</form>

{% if results %}
<div class="bg-white rounded-xl shadow border border-slate-200 overflow-x-auto">
  <table class="min-w-full text-sm">
    <thead class="bg-white border-b">
      <tr class="text-slate-600">
        <th class="px-4 py-3 text-left">First</th>
        <th class="px-4 py-3 text-left">Last</th>
        <th class="px-4 py-3 text-left">Email</th>
        <th class="px-4 py-3 text-left">Phone</th>
        <th class="px-4 py-3 text-left">DL</th>
        <th class="px-4 py-3 text-left">Date of Loss</th>
      </tr>
    </thead>
    <tbody class="divide-y">
      {% for r in results %}
      <!-- r: 0 id, 1 first, 2 last, 3 email, 4 phone, 5 dl, 6 date, 7 law_firm_id -->
      <tr class="hover:bg-sand/40">
        <td class="px-4 py-3">{{ r[1] }}</td>
        <td class="px-4 py-3">{{ r[2] }}</td>
        <td class="px-4 py-3">{{ r[3] }}</td>
        <td class="px-4 py-3">{{ r[4] }}</td>
        <td class="px-4 py-3">{{ r[5] }}</td>
        <td class="px-4 py-3">{{ r[6] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% elif results is not none and request.method == 'POST' %}
  <div class="rounded-lg bg-yellow-50 text-yellow-800 p-3">No results found.</div>
{% endif %}
{% endblock %}
